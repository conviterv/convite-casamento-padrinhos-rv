import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { Heart, ChevronRight, ChevronLeft, Send, BookOpen, UserPlus, Star } from 'lucide-react';

// Componente Principal
export default function App() {
  const [isOpen, setIsOpen] = useState(false);
  const [currentPage, setCurrentPage] = useState(0);

  // Efeito para carregar fontes externas
  useEffect(() => {
    const link = document.createElement('link');
    link.href = 'https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Great+Vibes&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap';
    link.rel = 'stylesheet';
    document.head.appendChild(link);
  }, []);

  const totalPages = 4;

  const nextPage = () => {
    if (currentPage < totalPages - 1) setCurrentPage(curr => curr + 1);
  };

  const prevPage = () => {
    if (currentPage > 0) setCurrentPage(curr => curr - 1);
  };

  const openEnvelope = () => {
    setIsOpen(true);
    setTimeout(() => {
      // Pequeno delay para a animação do papel subindo
    }, 800);
  };

  return (
    <div className="min-h-screen bg-stone-100 flex items-center justify-center overflow-hidden p-4 font-serif relative">
      {/* Background Decorativo (Padrão Sutil) */}
      <div className="absolute inset-0 opacity-10 pointer-events-none" 
           style={{
             backgroundImage: `url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23bcaaa4' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`
           }}>
      </div>

      <AnimatePresence mode="wait">
        {!isOpen ? (
          <motion.div
            key="envelope"
            initial={{ scale: 0.8, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            exit={{ scale: 1.5, opacity: 0, transition: { duration: 0.8 } }}
            onClick={openEnvelope}
            className="cursor-pointer relative z-10 w-full max-w-sm"
          >
            {/* ENVELOPE FECHADO */}
            <div className="bg-[#e8e0d5] shadow-2xl rounded-lg w-full aspect-[4/3] relative flex items-center justify-center overflow-hidden border border-[#d7c9bc]">
              {/* Textura do papel do envelope */}
              <div className="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/cream-paper.png')]"></div>
              
              {/* Selo de Cera */}
              <motion.div 
                whileHover={{ scale: 1.1 }}
                whileTap={{ scale: 0.95 }}
                className="z-20 w-24 h-24 bg-[#cfb08a] rounded-full flex items-center justify-center shadow-lg border-4 border-[#bca07d] relative"
              >
                 <div className="text-white font-['Great_Vibes'] text-4xl pt-2">R & V</div>
              </motion.div>
              
              {/* Aba do envelope (Visual) */}
              <div className="absolute top-0 left-0 w-full h-1/2 bg-[#dfd3c3] clip-path-triangle shadow-inner origin-top z-10" style={{clipPath: 'polygon(0 0, 100% 0, 50% 100%)'}}></div>
              
              <div className="absolute bottom-10 text-[#8c7b75] font-['Cinzel'] text-sm tracking-widest animate-pulse">
                Toque para abrir
              </div>
            </div>
          </motion.div>
        ) : (
          <motion.div
            key="card"
            initial={{ y: 100, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ type: "spring", stiffness: 50, delay: 0.5 }}
            className="w-full max-w-md bg-white rounded-xl shadow-2xl overflow-hidden relative z-20 min-h-[600px] flex flex-col border border-stone-200"
          >
            {/* Decoração Floral Superior */}
            <div className="absolute top-0 left-0 w-full h-24 bg-gradient-to-b from-rose-50 to-transparent opacity-60"></div>
            <div className="absolute top-[-20px] left-[-20px] w-32 h-32 bg-amber-100 rounded-full blur-3xl opacity-30"></div>
            
            {/* Conteúdo do Cartão */}
            <div className="flex-1 p-8 flex flex-col relative">
              
              {/* Indicador de Páginas */}
              <div className="flex justify-center space-x-2 mb-6">
                {[...Array(totalPages)].map((_, i) => (
                  <div 
                    key={i} 
                    className={`h-1.5 rounded-full transition-all duration-300 ${i === currentPage ? 'w-8 bg-[#cfb08a]' : 'w-2 bg-stone-200'}`}
                  />
                ))}
              </div>

              <div className="flex-1 flex flex-col justify-center">
                <AnimatePresence mode="wait">
                  <motion.div
                    key={currentPage}
                    initial={{ opacity: 0, x: 20 }}
                    animate={{ opacity: 1, x: 0 }}
                    exit={{ opacity: 0, x: -20 }}
                    transition={{ duration: 0.4 }}
                    className="text-center h-full flex flex-col justify-center"
                  >
                    {/* PAGINA 1: Anúncio */}
                    {currentPage === 0 && (
                      <div className="space-y-6">
                        <div className="flex justify-center text-[#cfb08a] mb-2">
                          <Star size={32} strokeWidth={1} />
                        </div>
                        <h1 className="font-['Cinzel'] text-2xl text-stone-800 tracking-wide">
                          Um Passo de Fé
                        </h1>
                        <div className="w-16 h-0.5 bg-[#cfb08a] mx-auto my-4"></div>
                        <p className="font-['Cormorant_Garamond'] text-xl text-stone-600 leading-relaxed italic">
                          "Melhor é serem dois do que um, porque têm melhor paga do seu trabalho. Porque se um cair, o outro levanta o seu companheiro."
                        </p>
                        <p className="text-xs text-stone-500 uppercase tracking-widest font-['Cinzel'] mt-2">
                          Eclesiastes 4:9-10
                        </p>
                        <div className="mt-8 font-['Cormorant_Garamond'] text-lg text-stone-700">
                          Com corações gratos a Deus, anunciamos o início da nossa jornada rumo ao altar.
                        </div>
                      </div>
                    )}

                    {/* PAGINA 2: Apresentação e Pais */}
                    {currentPage === 1 && (
                      <div className="space-y-4">
                        <div className="font-['Great_Vibes'] text-5xl text-[#cfb08a] mb-2 leading-tight">
                          Ronaldo <br/> <span className="text-3xl text-stone-400">&</span> <br/> Vitória
                        </div>
                        
                        <div className="text-xs text-stone-400 uppercase tracking-widest mb-4">
                          Filhos de
                        </div>

                        <div className="grid gap-6 font-['Cormorant_Garamond'] text-stone-700">
                          <div className="border-b border-stone-100 pb-2">
                            <p className="font-semibold text-lg">Natividade Pereira de Araújo</p>
                            <p className="font-semibold text-lg">& Maria Barros de Araújo</p>
                          </div>
                          <div className="border-b border-stone-100 pb-2">
                            <p className="font-semibold text-lg">Reilson Barbosa Santos</p>
                            <p className="font-semibold text-lg">& Vânia Nunes de Araújo Pereira</p>
                          </div>
                        </div>

                        <div className="mt-6 bg-stone-50 p-4 rounded-lg border border-stone-100">
                          <h3 className="font-['Cinzel'] text-sm text-[#cfb08a] mb-2">O Cordão de Três Dobras</h3>
                          <p className="text-sm italic text-stone-600 font-serif leading-relaxed">
                            "E, se alguém prevalecer contra um, os dois lhe resistirão; e o cordão de três dobras não se quebra tão depressa." (Ecl 4:12). <br/>
                            <span className="not-italic mt-2 block text-xs">Acreditamos que Deus é a primeira dobra, nós a segunda, e precisamos de testemunhas fiéis como a terceira dobra de oração e suporte.</span>
                          </p>
                        </div>
                      </div>
                    )}

                    {/* PAGINA 3: A Petição */}
                    {currentPage === 2 && (
                      <div className="space-y-6">
                        <div className="flex justify-center text-[#cfb08a] mb-4">
                          <UserPlus size={40} strokeWidth={1} />
                        </div>
                        <h2 className="font-['Cinzel'] text-xl text-stone-800">
                          Uma Petição de Honra
                        </h2>
                        
                        <div className="py-6 px-4 bg-white border border-[#cfb08a] rounded-sm shadow-sm relative mx-2">
                          {/* Elementos decorativos cantos */}
                          <div className="absolute top-1 left-1 w-3 h-3 border-t border-l border-[#cfb08a]"></div>
                          <div className="absolute top-1 right-1 w-3 h-3 border-t border-r border-[#cfb08a]"></div>
                          <div className="absolute bottom-1 left-1 w-3 h-3 border-b border-l border-[#cfb08a]"></div>
                          <div className="absolute bottom-1 right-1 w-3 h-3 border-b border-r border-[#cfb08a]"></div>
                          
                          <p className="font-['Cormorant_Garamond'] text-xl text-stone-800 mb-4 leading-relaxed">
                            É com grande alegria e oração que convidamos
                          </p>
                          
                          <div className="font-['Great_Vibes'] text-3xl text-[#cfb08a] my-4 transform -rotate-2">
                            Vocês e sua Família
                          </div>

                          <p className="font-['Cormorant_Garamond'] text-lg text-stone-700 leading-relaxed">
                            Para serem testemunhas da nossa aliança e pilares da nossa fé. Não buscamos apenas convidados, mas intercessores.
                          </p>
                        </div>

                        <p className="font-['Cinzel'] text-lg text-stone-800 mt-6 font-semibold">
                          Aceitam esta missão de amor e aliança?
                        </p>
                      </div>
                    )}

                    {/* PAGINA 4: Aceite e Manual */}
                    {currentPage === 3 && (
                      <div className="space-y-6 flex flex-col items-center justify-center h-full">
                        <div className="flex justify-center text-[#cfb08a] mb-2">
                          <Heart size={48} fill="#fbece6" strokeWidth={1.5} />
                        </div>
                        
                        <h2 className="font-['Cinzel'] text-xl text-stone-800">
                          Sua Resposta é uma Bênção
                        </h2>

                        <p className="font-['Cormorant_Garamond'] text-stone-600 text-lg px-2">
                          Para aceitar esta missão, clique no botão abaixo. 
                        </p>

                        <a 
                          href={`https://wa.me/?text=${encodeURIComponent("Queridos Noivos, Ronaldo e Vitória,\n\nRecebemos com grande alegria e honra o convite para testemunhar esta nova aliança firmada em Deus. Agradecemos a consideração e a oportunidade de nos alegrarmos convosco. Já estamos ansiosos pelos detalhes! Deus abençoe a união de vocês.")}`}
                          target="_blank"
                          rel="noopener noreferrer"
                          className="w-full bg-[#cfb08a] hover:bg-[#bca07d] text-white py-4 px-6 rounded-lg shadow-md flex items-center justify-center space-x-3 transition-transform transform hover:scale-105 active:scale-95 group"
                        >
                          <Send size={20} className="group-hover:translate-x-1 transition-transform" />
                          <span className="font-['Cinzel'] tracking-wider text-sm font-semibold">
                            ACEITAR CONVITE
                          </span>
                        </a>
                        <p className="text-xs text-stone-400 mt-2 italic">
                          (Você será redirecionado para escolher o contato dos noivos no WhatsApp)
                        </p>

                        <div className="w-full border-t border-stone-200 my-4"></div>

                        <div className="bg-stone-50 p-4 rounded-lg w-full text-left flex items-start space-x-3">
                          <BookOpen size={24} className="text-[#cfb08a] mt-1 shrink-0" />
                          <div>
                            <h3 className="font-['Cinzel'] text-stone-800 text-sm font-bold mb-1">
                              Próximo Passo: O Manual
                            </h3>
                            <p className="font-['Cormorant_Garamond'] text-stone-600 text-sm leading-snug">
                              Após o aceite, enviaremos o <strong>Manual dos Padrinhos</strong> contendo o protocolo, código de trajes (Dress Code), data, horário e localização da Igreja.
                            </p>
                            <p className="text-xs text-[#cfb08a] mt-2 font-semibold uppercase">
                              A confirmação de presença (RSVP) será solicitada apenas após o recebimento do manual.
                            </p>
                          </div>
                        </div>
                      </div>
                    )}
                  </motion.div>
                </AnimatePresence>
              </div>

              {/* Botões de Navegação */}
              <div className="flex justify-between items-center mt-6 pt-4 border-t border-stone-100">
                <button 
                  onClick={prevPage} 
                  disabled={currentPage === 0}
                  className={`p-2 rounded-full transition-colors ${currentPage === 0 ? 'text-stone-300 cursor-not-allowed' : 'text-[#cfb08a] hover:bg-stone-50'}`}
                >
                  <ChevronLeft size={24} />
                </button>
                
                <span className="text-xs text-stone-400 font-['Cinzel'] tracking-widest">
                  {currentPage + 1} / {totalPages}
                </span>

                <button 
                  onClick={nextPage} 
                  disabled={currentPage === totalPages - 1}
                  className={`p-2 rounded-full transition-colors ${currentPage === totalPages - 1 ? 'text-stone-300 cursor-not-allowed' : 'text-[#cfb08a] hover:bg-stone-50'}`}
                >
                  <ChevronRight size={24} />
                </button>
              </div>
            </div>
            
            {/* Decoração Floral Inferior */}
            <div className="absolute bottom-0 right-0 w-full h-24 bg-gradient-to-t from-rose-50 to-transparent opacity-60 pointer-events-none"></div>
             <div className="absolute bottom-[-20px] right-[-20px] w-40 h-40 bg-rose-100 rounded-full blur-3xl opacity-30 pointer-events-none"></div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
